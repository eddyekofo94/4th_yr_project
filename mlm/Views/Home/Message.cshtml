@model TModel

@{
    ViewBag.Title = "title";
    Layout = "_Layout";
}

<h2>Messages</h2>

<div id="chat">
    <form id="frm-send-message" action="#">
        <label for="message">Message:</label>
        <input type="text" id="message" />
        <input type="submit" id="send" value="Send" />
    </form>
    <div class="clear">
    </div>
    <ul id="messages"></ul>
    
    <script>
        var transportType = signalR.TransportType.WebSockets;
        var http = new signalR.HttpConnection(`http://${document.location.host}/chat`, { transport: transportType });
        var connection = new signalR.HubConnection(http);
        connection.start();
 
        connection.on('Send', (message) => {
            appendLine(message);    
        });
 
        document.getElementById('frm-send-message').addEventListener('submit', event => {
            var message = document.getElementById('message').value;
            document.getElementById('message').value = '';
 
            connection.invoke('Send', message);   
            event.preventDefault();
        });
 
        function appendLine(line, color) {
            var li = document.createElement('li');
            li.innerText = line;
            document.getElementById('messages').appendChild(li);
        };
 
    </script>
</div>